{"version":3,"sources":["/Users/jean-francoisrioux-bergeron/beriox-ai/jest.setup.js"],"sourcesContent":["import '@testing-library/jest-dom';\nimport 'jest-axe/extend-expect';\n\n// Mock Next.js Image component\njest.mock('next/image', () => ({\n  __esModule: true,\n  default: (props) => {\n    // eslint-disable-next-line @next/next/no-img-element\n    return <img {...props} alt={props.alt || ''} />;\n  },\n}));\n\n// Mock Next.js Link component\njest.mock('next/link', () => ({\n  __esModule: true,\n  default: ({ children, href, ...props }) => {\n    return (\n      <a href={href} {...props}>\n        {children}\n      </a>\n    );\n  },\n}));\n\n// Mock Next.js useRouter\njest.mock('next/router', () => ({\n  useRouter() {\n    return {\n      route: '/',\n      pathname: '/',\n      query: {},\n      asPath: '/',\n      push: jest.fn(),\n      pop: jest.fn(),\n      reload: jest.fn(),\n      back: jest.fn(),\n      prefetch: jest.fn().mockResolvedValue(undefined),\n      beforePopState: jest.fn(),\n      events: {\n        on: jest.fn(),\n        off: jest.fn(),\n        emit: jest.fn(),\n      },\n      isFallback: false,\n    };\n  },\n}));\n\n// Mock Next.js navigation\njest.mock('next/navigation', () => ({\n  useRouter() {\n    return {\n      push: jest.fn(),\n      replace: jest.fn(),\n      prefetch: jest.fn(),\n      back: jest.fn(),\n      forward: jest.fn(),\n      refresh: jest.fn(),\n    };\n  },\n  useSearchParams() {\n    return new URLSearchParams();\n  },\n  usePathname() {\n    return '/';\n  },\n}));\n\n// Mock environment variables\nprocess.env.NEXTAUTH_URL = 'http://localhost:3000';\nprocess.env.NEXTAUTH_SECRET = 'test-secret';\nprocess.env.OPENAI_API_KEY = 'test-openai-key';\nprocess.env.STRIPE_SECRET_KEY = 'test-stripe-key';\nprocess.env.STRIPE_WEBHOOK_SECRET = 'test-webhook-secret';\nprocess.env.RESEND_API_KEY = 'test-resend-key';\nprocess.env.REDIS_URL = 'redis://localhost:6379';\nprocess.env.DATABASE_URL = 'postgresql://test:test@localhost:5432/test';\n\n// Mock console methods to reduce noise in tests\nconst originalError = console.error;\nconst originalWarn = console.warn;\n\nbeforeAll(() => {\n  console.error = (...args) => {\n    if (\n      typeof args[0] === 'string' &&\n      args[0].includes('Warning: ReactDOM.render is no longer supported')\n    ) {\n      return;\n    }\n    originalError.call(console, ...args);\n  };\n\n  console.warn = (...args) => {\n    if (\n      typeof args[0] === 'string' &&\n      (args[0].includes('Warning: componentWillReceiveProps') ||\n        args[0].includes('Warning: componentWillUpdate'))\n    ) {\n      return;\n    }\n    originalWarn.call(console, ...args);\n  };\n});\n\nafterAll(() => {\n  console.error = originalError;\n  console.warn = originalWarn;\n});\n\n// Global test utilities\nglobal.ResizeObserver = jest.fn().mockImplementation(() => ({\n  observe: jest.fn(),\n  unobserve: jest.fn(),\n  disconnect: jest.fn(),\n}));\n\nglobal.IntersectionObserver = jest.fn().mockImplementation(() => ({\n  observe: jest.fn(),\n  unobserve: jest.fn(),\n  disconnect: jest.fn(),\n}));\n\n// Mock matchMedia\nObject.defineProperty(window, 'matchMedia', {\n  writable: true,\n  value: jest.fn().mockImplementation(query => ({\n    matches: false,\n    media: query,\n    onchange: null,\n    addListener: jest.fn(), // deprecated\n    removeListener: jest.fn(), // deprecated\n    addEventListener: jest.fn(),\n    removeEventListener: jest.fn(),\n    dispatchEvent: jest.fn(),\n  })),\n});\n\n// Mock localStorage\nconst localStorageMock = {\n  getItem: jest.fn(),\n  setItem: jest.fn(),\n  removeItem: jest.fn(),\n  clear: jest.fn(),\n};\nglobal.localStorage = localStorageMock;\n\n// Mock sessionStorage\nconst sessionStorageMock = {\n  getItem: jest.fn(),\n  setItem: jest.fn(),\n  removeItem: jest.fn(),\n  clear: jest.fn(),\n};\nglobal.sessionStorage = sessionStorageMock;\n\n// Mock fetch\nglobal.fetch = jest.fn();\n\n// Custom matchers\nexpect.extend({\n  toHaveBeenCalledWithMatch(received, expected) {\n    const pass = received.mock.calls.some(call => {\n      try {\n        expect(call).toEqual(expect.arrayContaining([expected]));\n        return true;\n      } catch {\n        return false;\n      }\n    });\n\n    if (pass) {\n      return {\n        message: () =>\n          `expected ${received.getMockName()} not to have been called with ${JSON.stringify(expected)}`,\n        pass: true,\n      };\n    } else {\n      return {\n        message: () =>\n          `expected ${received.getMockName()} to have been called with ${JSON.stringify(expected)}`,\n        pass: false,\n      };\n    }\n  },\n});\n\n// Test utilities\nglobal.waitForLoadingToFinish = () =>\n  new Promise(resolve => setTimeout(resolve, 0));\n\nglobal.mockApiResponse = (data, status = 200) => {\n  global.fetch.mockResolvedValueOnce({\n    ok: status >= 200 && status < 300,\n    status,\n    json: async () => data,\n    text: async () => JSON.stringify(data),\n  });\n};\n\nglobal.mockApiError = (error, status = 500) => {\n  global.fetch.mockRejectedValueOnce(new Error(error));\n};\n\n// Cleanup after each test\nafterEach(() => {\n  jest.clearAllMocks();\n  jest.clearAllTimers();\n});\n\n// Global test timeout\njest.setTimeout(10000);\n"],"names":["jest","mock","__esModule","default","props","img","alt","children","href","a","useRouter","route","pathname","query","asPath","push","fn","pop","reload","back","prefetch","mockResolvedValue","undefined","beforePopState","events","on","off","emit","isFallback","replace","forward","refresh","useSearchParams","URLSearchParams","usePathname","process","env","NEXTAUTH_URL","NEXTAUTH_SECRET","OPENAI_API_KEY","STRIPE_SECRET_KEY","STRIPE_WEBHOOK_SECRET","RESEND_API_KEY","REDIS_URL","DATABASE_URL","originalError","console","error","originalWarn","warn","beforeAll","args","includes","call","afterAll","global","ResizeObserver","mockImplementation","observe","unobserve","disconnect","IntersectionObserver","Object","defineProperty","window","writable","value","matches","media","onchange","addListener","removeListener","addEventListener","removeEventListener","dispatchEvent","localStorageMock","getItem","setItem","removeItem","clear","localStorage","sessionStorageMock","sessionStorage","fetch","expect","extend","toHaveBeenCalledWithMatch","received","expected","pass","calls","some","toEqual","arrayContaining","message","getMockName","JSON","stringify","waitForLoadingToFinish","Promise","resolve","setTimeout","mockApiResponse","data","status","mockResolvedValueOnce","ok","json","text","mockApiError","mockRejectedValueOnce","Error","afterEach","clearAllMocks","clearAllTimers"],"mappings":"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"}